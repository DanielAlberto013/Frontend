<div class="catalogo-container">
  <!-- Header Mejorado -->
  <div class="header-section">
    <div class="header-content">
      <div class="header-icon">
        <i class="fas fa-boxes"></i>
      </div>
      <div class="header-text">
        <h1>Catálogo de Artículos</h1>
        <p>Lista de artículos disponibles para cotizaciones</p>
      </div>
    </div>
    
    <!-- Botón para regresar al dashboard -->
    <button class="btn btn-dashboard" routerLink="/dashboard">
      <i class="fas fa-tachometer-alt"></i>
      Volver al Dashboard
    </button>
  </div>

  <!-- Filtros Mejorados -->
  <div class="filters-section">
    <div class="filters-card">
      <div class="filters-content">
        <div class="search-container">
          <div class="search-input-wrapper">
            <i class="fas fa-search search-icon"></i>
            <input 
              type="text" 
              [(ngModel)]="searchTerm" 
              (ngModelChange)="onSearchChange()"
              placeholder="Buscar artículo por nombre..." 
              class="search-input"
            >
          </div>
          
          <div class="select-wrapper">
            <i class="fas fa-filter select-icon"></i>
            <select 
              [(ngModel)]="partidaFilter" 
              (ngModelChange)="onPartidaFilterChange()"
              class="filter-select"
            >
              <option value="">Todas las partidas</option>
              <option *ngFor="let partida of partidasConNombre" [value]="partida.codigo">
                {{ partida.codigo }} - {{ partida.nombre }}
              </option>
            </select>
          </div>

          <button (click)="limpiarFiltros()" class="btn btn-clear">
            <i class="fas fa-broom"></i>
            Limpiar Filtros
          </button>

          <!-- Botón para agregar nuevo artículo (solo admin/revisor) -->
          <button 
            *ngIf="authService.isAdmin() || authService.isRevisor()"
            class="btn btn-primary btn-new"
            (click)="agregarNuevoArticulo()"
          >
            <i class="fas fa-plus-circle"></i>
            Nuevo Artículo
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Estados de Carga y Error Mejorados -->
  <div *ngIf="loading" class="state-container loading-state">
    <div class="spinner"></div>
    <p>Cargando catálogo...</p>
  </div>

  <div *ngIf="error && !loading" class="state-container error-state">
    <div class="error-icon">
      <i class="fas fa-exclamation-triangle"></i>
    </div>
    <h3>Error al cargar el catálogo</h3>
    <p>{{ error }}</p>
    <button (click)="cargarArticulos()" class="btn btn-retry">
      <i class="fas fa-redo"></i>
      Reintentar
    </button>
  </div>

  <!-- Grid de Artículos Mejorado -->
  <div *ngIf="!loading && !error" class="articles-section">
    <div *ngIf="articulosFiltrados.length === 0" class="state-container empty-state">
      <div class="empty-icon">
        <i class="fas fa-inbox"></i>
      </div>
      <h3>No se encontraron artículos</h3>
      <p>No hay artículos que coincidan con los filtros aplicados</p>
      <button (click)="limpiarFiltros()" class="btn btn-primary">
        <i class="fas fa-eye"></i>
        Ver todos los artículos
      </button>
    </div>

    <div *ngIf="articulosFiltrados.length > 0" class="articles-grid">
      <div 
        *ngFor="let articulo of articulosFiltrados" 
        class="article-card"
        [class.inactive]="!articulo.activo"
      >
        <div class="card-header">
          <div class="article-title-section">
            <h3 class="article-title">{{ articulo.nombre }}</h3>
            <span class="partida-badge">{{ articulo.partidaCodigo }} - {{ getNombrePartida(articulo.partidaCodigo) }}</span>
          </div>
          <div class="status-indicator" [class.active]="articulo.activo" [class.inactive]="!articulo.activo">
            <i class="fas" [class.fa-check-circle]="articulo.activo" [class.fa-times-circle]="!articulo.activo"></i>
            {{ articulo.activo ? 'Activo' : 'Inactivo' }}
          </div>
        </div>
        
        <div class="article-details">
          <div class="price-section">
            <span class="price-label">Precio de referencia:</span>
            <span class="price-value">${{ articulo.precioReferencia | number:'1.2-2' }}</span>
          </div>
        </div>

        <!-- Acciones Mejoradas -->
        <div class="article-actions">
          <!-- ELIMINADO: Botón "Agregar a Cotización" para docentes -->
          <!-- Los docentes solo ven los artículos, las cotizaciones se manejan en otra sección -->

          <button 
            *ngIf="authService.isAdmin() || authService.isRevisor()"
            class="btn btn-action btn-edit"
            (click)="editarArticulo(articulo)"
          >
            <i class="fas fa-edit"></i>
            Editar
          </button>

          <button 
            *ngIf="(authService.isAdmin() || authService.isRevisor()) && articulo.activo"
            (click)="desactivarArticulo(articulo)"
            class="btn btn-action btn-deactivate"
          >
            <i class="fas fa-ban"></i>
            Desactivar
          </button>
        </div>
      </div>
    </div>
  </div>
</div>